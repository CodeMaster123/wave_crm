<%- model_class = Lead -%>
<div class="page-header">
    <h1><%=t '.title', :default => model_class.model_name.human %></h1>
</div>

<dl class="dl-horizontal">
    <h4><%= @lead.contacts.first.full_name %> - Company_name</h4>
    <dt><strong>Lead owner :</strong></dt>
    <dd><%= @lead.leadable.user.full_name %></dd>
    <dt><strong>Title :</strong></dt>
    <dd><%= @lead.title %></dd>
    <dt><strong> Description :</strong></dt>
    <dd><%= @lead.description %></dd>
    <dt><strong> Phone number :</strong></dt>
    <dd><%= @lead.contacts.first.landline_no %></dd>
    <dt><strong> Mobile number :</strong></dt>
    <dd><%= @lead.contacts.first.mobile_no %></dd>
    <dt><strong> Lead status :</strong></dt>
    <dd><%= @lead.contacts.first.mobile_no %></dd>
</dl>

<div><h6>Closed Meetings</h6></div>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Title</th>
            <th>starts at</th>
            <th>Ends at</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody id="search-data">
        <% @lead_events.each do |event| %>
            <% if event.starts_at.to_date < Date.today %>
            <tr>
                <td><%= event.title %></td>
                <td><%= event.starts_at.strftime("%I:%M%P  %d-%b-%Y") %></td>
                <td><%= event.ends_at.strftime("%I:%M%P  %d-%b-%Y") %></td>
                <td><%= event.description %></td>
            </tr>
        <% end %>
        <% end %>
    </tbody>
</table>

<div><h6>Pending Meetings</h6></div>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Title</th>
            <th>starts at</th>
            <th>Ends at</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody id="search-data">
        <% @lead_events.each do |event| %>
            <% if event.starts_at.to_date >= Date.today %>
                <tr>
                    <td><%= event.title %></td>
                    <td><%= event.starts_at.strftime("%I:%M%P  %d-%b-%Y") %></td>
                    <td><%= event.ends_at.strftime("%I:%M%P  %d-%b-%Y") %></td>
                    <td><%= event.description %></td>
                </tr>
            <% end %>
        <% end %>
    </tbody>
</table>

<div><h6>Call logs</h6></div>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Subject</th>
            <th>Call result</th>
            <th>Call type</th>
            <th>Call purpose</th>
            <th>Call start time</th>
            <th>Call duration</th>
            <th>Owner name</th>
            <th>Modified at</th>
        </tr>
    </thead>
    <tbody id="search-data">
        <% @call_logs.each do |call_log| %>
            <tr>
                <td><%= call_log.subject %></td>
                <td><%= call_log.call_result %></td>
                <td><%= call_log.call_type %></td>
                <td><%= call_log.call_purpose %></td>
                <td><%= call_log.call_start_time.strftime('%l:%M%P %d-%b')%></td>
                <td><%= call_log.call_duration %></td>
                <td><%= call_log.call_owner_id %></td>
                <td><%=l call_log.updated_at %></td>
            </tr>
        <% end %>
    </tbody>
</table>

<div><h6>Emails/SMS</h6></div>
<table class="table table-striped">
    <thead>
        <tr>
            <th>SMS</th>
            <th>Email</th>
            <th>Sending time</th>
            <th>Body</th>
            <th>Content</th>
            <th>Modified at</th>
        </tr>
    </thead>
    <tbody id="search-data">
        <% @lead_notifications.each do |notification| %>
            <tr>
                <td><%= notification.check_if_sms %></td>
                <td><%= notification.check_if_email %></td>
                <td><%= notification.notification_time.strftime('%l:%M%P  %d-%b') %></td>
                <td></td>
                <td><%= notification.body %></td>
                <td><%= notification.updated_at.strftime('%l:%M%P %d-%b') %></td>
            </tr>
        <% end %>
    </tbody>
</table>

<div class="form-actions">
    <%= link_to t('.back', :default => t("helpers.links.back")), leads_path, :class => 'btn'  %>
    <%= link_to t('.edit', :default => t("helpers.links.edit")), edit_lead_path(@lead), :class => 'btn' %>
    <%= link_to t('.destroy', :default => t("helpers.links.destroy")), lead_path(@lead), :method => 'delete', :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-danger' %>
</div>



